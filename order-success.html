<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X√°c nh·∫≠n ƒë∆°n h√†ng - Moonlight Cafe</title>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/mobile.css">

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- QRCode Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        /* Order Success Page Styles */
        .order-success-section {
            padding: 60px 0;
            min-height: 80vh;
            background: var(--bg-dark);
        }

        .order-success-container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Success Header */
        .success-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .success-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--success), #22c55e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            animation: scaleIn 0.5s ease;
        }

        @keyframes scaleIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .success-icon i {
            font-size: 3rem;
            color: white;
        }

        .success-header h1 {
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .success-header p {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .order-number {
            display: inline-block;
            background: var(--primary-light);
            padding: 10px 25px;
            border-radius: var(--radius-full);
            margin-top: 20px;
            font-weight: 600;
        }

        .order-number span {
            color: var(--accent);
        }

        /* Bill Card */
        .bill-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .bill-header {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: var(--text-dark);
            padding: 30px;
            text-align: center;
        }

        .bill-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .bill-logo span:first-child {
            font-size: 2rem;
        }

        .bill-logo-text {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .bill-header p {
            font-size: 0.9rem;
            opacity: 0.9;
            margin: 5px 0;
        }

        .bill-info {
            display: flex;
            justify-content: space-between;
            padding: 20px 30px;
            background: var(--primary-light);
            border-bottom: 1px dashed var(--secondary);
        }

        .bill-info-item {
            text-align: center;
        }

        .bill-info-item label {
            display: block;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .bill-info-item span {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Order Items */
        .bill-items {
            padding: 20px 30px;
        }

        .bill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--secondary);
        }

        .bill-item:last-child {
            border-bottom: none;
        }

        .bill-item-info {
            flex: 1;
        }

        .bill-item-name {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .bill-item-qty {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .bill-item-price {
            font-weight: 600;
            color: var(--accent);
        }

        /* Bill Summary */
        .bill-summary {
            padding: 20px 30px;
            background: var(--primary-light);
            border-top: 2px dashed var(--secondary);
        }

        .bill-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: var(--text-secondary);
        }

        .bill-row.total {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            padding-top: 15px;
            margin-top: 10px;
            border-top: 1px solid var(--secondary);
        }

        .bill-row.total span:last-child {
            color: var(--accent);
        }

        /* Payment Info */
        .payment-info {
            padding: 25px 30px;
            background: var(--bg-dark);
            border-top: 1px solid var(--secondary);
        }

        .payment-info h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .payment-info h4 i {
            color: var(--accent);
        }

        .payment-method-display {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--primary-light);
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
        }

        .payment-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            font-size: 1.5rem;
        }

        .payment-icon.cod {
            background: rgba(74, 222, 128, 0.2);
            color: var(--success);
        }

        .payment-icon.bank {
            background: rgba(96, 165, 250, 0.2);
            color: var(--info);
        }

        .payment-icon.momo {
            background: #ae2070;
            color: white;
        }

        .payment-details {
            flex: 1;
        }

        .payment-details h5 {
            color: var(--text-primary);
            margin-bottom: 3px;
        }

        .payment-details p {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin: 0;
        }

        /* QR Code */
        .qr-section {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        .qr-code {
            background: white;
            padding: 15px;
            border-radius: var(--radius-sm);
            flex-shrink: 0;
        }

        .qr-info {
            flex: 1;
        }

        .bank-details {
            background: var(--primary-light);
            padding: 15px;
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
        }

        .bank-details p {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
        }

        .bank-details strong {
            color: var(--text-primary);
        }

        .bank-details span {
            color: var(--accent);
            font-weight: 600;
        }

        .transfer-note {
            margin-top: 15px;
            padding: 12px;
            background: rgba(212, 165, 116, 0.1);
            border-left: 3px solid var(--accent);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Order Timeline */
        .order-timeline {
            margin-top: 40px;
        }

        .timeline-title {
            font-size: 1.2rem;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
        }

        .timeline-title i {
            color: var(--accent);
        }

        .timeline {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .timeline::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50px;
            right: 50px;
            height: 3px;
            background: var(--secondary);
        }

        .timeline-step {
            text-align: center;
            position: relative;
            flex: 1;
        }

        .step-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-light);
            border: 3px solid var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            color: var(--text-muted);
            position: relative;
            z-index: 1;
        }

        .timeline-step.completed .step-icon {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .timeline-step.active .step-icon {
            background: var(--accent);
            border-color: var(--accent);
            color: var(--text-dark);
        }

        .step-label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .timeline-step.completed .step-label,
        .timeline-step.active .step-label {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Action Buttons */
        .order-actions {
            display: flex;
            gap: 15px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .order-actions .btn {
            flex: 1;
            min-width: 200px;
            padding: 15px 25px;
            font-size: 1rem;
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
            }

            .order-actions,
            .nav,
            .footer {
                display: none;
            }

            .bill-card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .bill-info {
                flex-direction: column;
                gap: 15px;
            }

            .qr-section {
                flex-direction: column;
            }

            .timeline {
                flex-direction: column;
                gap: 20px;
            }

            .timeline::before {
                display: none;
            }

            .order-actions {
                flex-direction: column;
            }

            .order-actions .btn {
                min-width: 100%;
            }
        }
    </style>
</head>

<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay">
        <div class="loader"></div>
    </div>

    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <nav class="nav">
                <a href="index.html" class="nav-brand">
                    <div class="nav-logo-wrapper"><img src="images/logo.png?v=4" alt="Moonlight Cafe" class="nav-logo"></div>
                    <span class="nav-brand-text">Moonlight Cafe</span>
                </a>

                <ul class="nav-menu" id="navMenu">
                    <li><a href="index.html" class="nav-link">Trang ch·ªß</a></li>
                    <li><a href="menu.html" class="nav-link">Menu</a></li>
                    <li><a href="promotions.html" class="nav-link">Khuy·∫øn m√£i</a></li>
                    <li><a href="news.html" class="nav-link">Tin t·ª©c</a></li>
                    <li><a href="about.html" class="nav-link">V·ªÅ ch√∫ng t√¥i</a></li>
                    <li><a href="contact.html" class="nav-link">Li√™n h·ªá</a></li>
                    <li><a href="reservation.html" class="nav-link">ƒê·∫∑t b√†n</a></li>
                </ul>

                <div class="nav-actions">
                    <a href="contact.html" class="nav-icon hidden" id="msgIcon" title="Tin nh·∫Øn t·ª´ ti·ªám">
                        <i class="fas fa-envelope"></i>
                        <span class="badge" id="msgCount" style="display:none">0</span>
                    </a>
                    <a href="cart.html" class="nav-icon">
                        <i class="fas fa-shopping-bag"></i>
                        <span class="badge" id="cartCount">0</span>
                    </a>
                    <a href="login.html" class="nav-icon">
                        <i class="fas fa-user"></i>
                    </a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Order Success Section -->
    <section class="order-success-section">
        <div class="container">
            <div class="order-success-container">

                <!-- Success Header -->
                <div class="success-header">
                    <div class="success-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <h1>ƒê·∫∑t h√†ng th√†nh c√¥ng!</h1>
                    <p>C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t h√†ng t·∫°i Moonlight Cafe</p>
                    <div class="order-number">
                        M√£ ƒë∆°n h√†ng: <span id="orderNumber">MLC-XXXXXXXX</span>
                    </div>
                </div>

                <!-- Bill Card -->
                <div class="bill-card" id="billCard">
                    <div class="bill-header">
                        <div class="bill-logo">
                            <div class="nav-logo-wrapper"><img src="images/logo.png?v=4" alt="Moonlight Cafe" class="nav-logo"></div>
                            <span class="bill-logo-text">Moonlight Cafe</span>
                        </div>
                        <p>66 Nguy·ªÖn ƒê·ªá, C√°i Kh·∫ø, C·∫ßn Th∆°</p>
                        <p>üìû 0110 766 204 | üìß moonlightcafe@gmail.com</p>
                    </div>

                    <div class="bill-info">
                        <div class="bill-info-item">
                            <label>Ng√†y ƒë·∫∑t</label>
                            <span id="orderDate">--/--/----</span>
                        </div>
                        <div class="bill-info-item">
                            <label>Kh√°ch h√†ng</label>
                            <span id="customerName">---</span>
                        </div>
                        <div class="bill-info-item">
                            <label>Ph∆∞∆°ng th·ª©c</label>
                            <span id="paymentMethod">---</span>
                        </div>
                        <div class="bill-info-item">
                            <label>Tr·∫°ng th√°i</label>
                            <span id="orderStatus" style="color: var(--warning);">Ch·ªù x√°c nh·∫≠n</span>
                        </div>
                    </div>

                    <div class="bill-items" id="billItems">
                        <!-- Items will be loaded here -->
                    </div>

                    <div class="bill-summary">
                        <div class="bill-row">
                            <span>T·∫°m t√≠nh</span>
                            <span id="subtotal">0ƒë</span>
                        </div>
                        <div class="bill-row">
                            <span>Ph√≠ v·∫≠n chuy·ªÉn</span>
                            <span id="shipping">0ƒë</span>
                        </div>
                        <div class="bill-row total">
                            <span>T·ªîNG C·ªòNG</span>
                            <span id="total">0ƒë</span>
                        </div>
                    </div>

                    <div class="payment-info" id="paymentInfo">
                        <!-- Payment details will be loaded here -->
                    </div>
                </div>

                <!-- Order Timeline -->
                <div class="order-timeline">
                    <h3 class="timeline-title">
                        <i class="fas fa-shipping-fast"></i> Theo d√µi ƒë∆°n h√†ng
                    </h3>
                    <div class="timeline">
                        <div class="timeline-step completed">
                            <div class="step-icon"><i class="fas fa-check"></i></div>
                            <span class="step-label">ƒê·∫∑t h√†ng</span>
                        </div>
                        <div class="timeline-step active">
                            <div class="step-icon"><i class="fas fa-receipt"></i></div>
                            <span class="step-label">X√°c nh·∫≠n</span>
                        </div>
                        <div class="timeline-step">
                            <div class="step-icon"><i class="fas fa-box"></i></div>
                            <span class="step-label">Chu·∫©n b·ªã</span>
                        </div>
                        <div class="timeline-step">
                            <div class="step-icon"><i class="fas fa-truck"></i></div>
                            <span class="step-label">Giao h√†ng</span>
                        </div>
                        <div class="timeline-step">
                            <div class="step-icon"><i class="fas fa-home"></i></div>
                            <span class="step-label">Ho√†n th√†nh</span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="order-actions">
                    <a href="orders.html" class="btn btn-primary">
                        <i class="fas fa-list"></i> Xem ƒë∆°n h√†ng
                    </a>
                    <a href="menu.html" class="btn btn-outline">
                        <i class="fas fa-coffee"></i> Ti·∫øp t·ª•c mua
                    </a>
                    <button class="btn btn-outline" onclick="printBill()">
                        <i class="fas fa-print"></i> In h√≥a ƒë∆°n
                    </button>
                </div>

            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <div class="footer-brand">
                        <div class="nav-logo-wrapper"><img src="images/logo.png?v=4" alt="Moonlight Cafe" class="nav-logo"></div>
                        <span class="nav-brand-text">Moonlight Cafe</span>
                    </div>
                    <p id="footer-slogan">N∆°i th∆∞·ªüng th·ª©c c√† ph√™ v√† b√°nh ng·ªçt th∆∞·ª£ng h·∫°ng trong kh√¥ng gian ·∫•m c√∫ng d∆∞·ªõi √°nh trƒÉng.</p>
                    <div class="footer-social">
                        <a href="#" id="footer-fb"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" id="footer-ig"><i class="fab fa-instagram"></i></a>
                        <a href="#" id="footer-tt"><i class="fab fa-tiktok"></i></a>
                        <a href="#" id="footer-yt"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4 class="footer-title">Li√™n k·∫øt nhanh</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Trang ch·ªß</a></li>
                        <li><a href="menu.html">Menu</a></li>
                        <li><a href="promotions.html">Khuy·∫øn m√£i</a></li>
                        <li><a href="news.html">Tin t·ª©c</a></li>
                        <li><a href="about.html">V·ªÅ ch√∫ng t√¥i</a></li>
                        <li><a href="contact.html">Li√™n h·ªá</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="footer-title">Li√™n h·ªá</h4>
                    <ul class="footer-contact">
                        <li><i class="fas fa-map-marker-alt"></i> <span id="footer-address">66 Nguy·ªÖn ƒê·ªá, C√°i Kh·∫ø, C·∫ßn Th∆°</span></li>
                        <li><i class="fas fa-phone"></i> <span id="footer-phone">0110 766 204</span></li>
                        <li><i class="fas fa-envelope"></i> <span id="footer-email">moonlightcafe@gmail.com</span></li>
                        <li><i class="fas fa-clock"></i> <span id="footer-hours">7:00 - 22:00 h√†ng ng√†y</span></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p id="footer-copyright">&copy; 2026 Moonlight Cafe. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script type="module">
        // Order data - In production, this would come from Firebase
        let currentOrder = null;

        // Format price
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(price);
        }

        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('vi-VN', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Get order from localStorage (set during checkout)
        function getOrder() {
            const orderData = localStorage.getItem('moonlight_last_order');

            console.log('LocalStorage data:', orderData);

            if (orderData) {
                try {
                    return JSON.parse(orderData);
                } catch (e) {
                    console.error('Error parsing order data:', e);
                }
            }

            // Demo data for testing - n·∫øu kh√¥ng c√≥ d·ªØ li·ªáu
            console.log('Using demo data');
            return {
                id: 'ORD' + Date.now().toString().slice(-8),
                customer: {
                    fullName: 'Nguy·ªÖn VƒÉn A',
                    phone: '0123 456 789',
                    email: 'nguyenvana@email.com',
                    address: '123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP. HCM'
                },
                items: [
                    { name: 'Cappuccino', price: 45000, quantity: 2, total: 90000 },
                    { name: 'Matcha Latte', price: 55000, quantity: 1, total: 55000 },
                    { name: 'Tiramisu', price: 65000, quantity: 1, total: 65000 }
                ],
                subtotal: 210000,
                shipping: 0,
                total: 210000,
                payment: 'cod',
                status: 'pending',
                createdAt: new Date().toISOString()
            };
        }

        // Render order details
        function renderOrder() {
            try {
                currentOrder = getOrder();

                console.log('Current order:', currentOrder);

                // Ki·ªÉm tra n·∫øu kh√¥ng c√≥ th√¥ng tin ƒë∆°n h√†ng
                if (!currentOrder) {
                    document.querySelector('.order-success-container').innerHTML = `
                        <div class="text-center" style="padding: 60px 20px;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 4rem; color: var(--warning); margin-bottom: 20px;"></i>
                            <h2>Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng!</h2>
                            <p>Vui l√≤ng ƒë·∫∑t h√†ng l·∫°i.</p>
                            <a href="menu.html" class="btn btn-primary" style="margin-top: 20px;">
                                <i class="fas fa-coffee"></i> Xem menu
                            </a>
                        </div>
                    `;
                    return;
                }

                // Header info
                document.getElementById('orderNumber').textContent = '#' + currentOrder.id.slice(-8).toUpperCase();
                document.getElementById('orderDate').textContent = formatDate(currentOrder.createdAt);
                document.getElementById('customerName').textContent = currentOrder.customer.fullName;

                // Payment method
                const paymentMethods = {
                    'cod': { name: 'Thanh to√°n khi nh·∫≠n h√†ng', icon: 'fa-money-bill-wave', class: 'cod' },
                    'banking': { name: 'Chuy·ªÉn kho·∫£n ng√¢n h√†ng', icon: 'fa-university', class: 'bank' },
                    'momo': { name: 'V√≠ MoMo', icon: 'fa-wallet', class: 'momo' }
                };
                const payment = paymentMethods[currentOrder.payment] || paymentMethods.cod;
                document.getElementById('paymentMethod').textContent = payment.name;

                // Render items
                if (currentOrder.items && currentOrder.items.length > 0) {
                    const itemsHtml = currentOrder.items.map(item => `
                        <div class="bill-item">
                            <div class="bill-item-info">
                                <div class="bill-item-name">${item.name}</div>
                                <div class="bill-item-qty">${item.quantity} x ${formatPrice(item.price)}</div>
                            </div>
                            <div class="bill-item-price">${formatPrice(item.total || (item.price * item.quantity))}</div>
                        </div>
                    `).join('');
                    document.getElementById('billItems').innerHTML = itemsHtml;
                } else {
                    document.getElementById('billItems').innerHTML = '<p class="text-center">Kh√¥ng c√≥ s·∫£n ph·∫©m</p>';
                }

                // Render summary
                document.getElementById('subtotal').textContent = formatPrice(currentOrder.subtotal);
                document.getElementById('shipping').textContent = currentOrder.shipping === 0 ? 'Mi·ªÖn ph√≠' : formatPrice(currentOrder.shipping);
                document.getElementById('total').textContent = formatPrice(currentOrder.total);

                // Render payment info
                renderPaymentInfo(payment);

            } catch (error) {
                console.error('Error rendering order:', error);
                document.querySelector('.order-success-container').innerHTML = `
                    <div class="text-center" style="padding: 60px 20px;">
                        <i class="fas fa-exclamation-circle" style="font-size: 4rem; color: var(--danger); margin-bottom: 20px;"></i>
                        <h2>C√≥ l·ªói x·∫£y ra!</h2>
                        <p>${error.message}</p>
                        <a href="menu.html" class="btn btn-primary" style="margin-top: 20px;">
                            <i class="fas fa-coffee"></i> Quay v·ªÅ menu
                        </a>
                    </div>
                `;
            }
        }

        // Render payment info with QR code
        function renderPaymentInfo(payment) {
            // Ki·ªÉm tra n·∫øu kh√¥ng c√≥ currentOrder
            if (!currentOrder) {
                currentOrder = getOrder();
            }

            const paymentInfo = document.getElementById('paymentInfo');

            if (!currentOrder.payment || currentOrder.payment === 'cod') {
                paymentInfo.innerHTML = `
                    <h4><i class="fas fa-money-bill-wave"></i> Thanh to√°n khi nh·∫≠n h√†ng (COD)</h4>
                    <p style="color: var(--text-muted);">
                        <i class="fas fa-info-circle"></i> 
                        B·∫°n s·∫Ω thanh to√°n b·∫±ng ti·ªÅn m·∫∑t khi nh·∫≠n ƒë∆∞·ª£c h√†ng.
                        Vui l√≤ng chu·∫©n b·ªã ƒë√∫ng s·ªë ti·ªÅn ${formatPrice(currentOrder.total)}.
                    </p>
                `;
            } else if (currentOrder.payment === 'banking') {
                paymentInfo.innerHTML = `
                    <h4><i class="fas fa-university"></i> Th√¥ng tin chuy·ªÉn kho·∫£n</h4>
                    <div class="qr-section">
                        <div class="qr-code" id="bankingQR"></div>
                        <div class="qr-info">
                            <div class="bank-details">
                                <p><strong>Ng√¢n h√†ng:</strong> <span>Vietcombank</span></p>
                                <p><strong>S·ªë TK:</strong> <span>1234567890123</span></p>
                                <p><strong>Ch·ªß TK:</strong> <span>NGUYEN VAN A</span></p>
                                <p><strong>S·ªë ti·ªÅn:</strong> <span>${formatPrice(currentOrder.total)}</span></p>
                                <p><strong>N·ªôi dung:</strong> <span>MLC${currentOrder.id.slice(-8).toUpperCase()}</span></p>
                            </div>
                            <div class="transfer-note">
                                <i class="fas fa-exclamation-circle"></i>
                                Vui l√≤ng chuy·ªÉn kho·∫£n ch√≠nh x√°c s·ªë ti·ªÅn v√† ghi ƒë√∫ng n·ªôi dung chuy·ªÉn kho·∫£n ƒë·ªÉ ƒë∆°n h√†ng ƒë∆∞·ª£c x·ª≠ l√Ω nhanh h∆°n.
                            </div>
                        </div>
                    </div>
                `;

                // Generate QR code
                setTimeout(() => {
                    const qrContainer = document.getElementById('bankingQR');
                    if (qrContainer && qrContainer.innerHTML === '') {
                        const qrData = `VCB|1234567890123|NGUYEN VAN A|${currentOrder.total}|MLC${currentOrder.id.slice(-8).toUpperCase()}`;
                        new QRCode(qrContainer, {
                            text: qrData,
                            width: 120,
                            height: 120,
                            colorDark: "#000000",
                            colorLight: "#ffffff",
                            correctLevel: QRCode.CorrectLevel.H
                        });
                    }
                }, 100);
            } else if (currentOrder.payment === 'momo') {
                paymentInfo.innerHTML = `
                    <h4><i class="fas fa-wallet"></i> Thanh to√°n qua MoMo</h4>
                    <div class="qr-section">
                        <div class="qr-code" id="momoQR" style="background: #ae2070;"></div>
                        <div class="qr-info">
                            <div class="bank-details">
                                <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span>0901234567</span></p>
                                <p><strong>T√™n t√†i kho·∫£n:</strong> <span>Moonlight Cafe</span></p>
                                <p><strong>S·ªë ti·ªÅn:</strong> <span>${formatPrice(currentOrder.total)}</span></p>
                                <p><strong>N·ªôi dung:</strong> <span>MLC${currentOrder.id.slice(-8).toUpperCase()}</span></p>
                            </div>
                            <div class="transfer-note">
                                <i class="fas fa-exclamation-circle"></i>
                                Sau khi chuy·ªÉn kho·∫£n, vui l√≤ng g·ª≠i screenshot qua Zalo c·ªßa shop ƒë·ªÉ x√°c nh·∫≠n.
                            </div>
                        </div>
                    </div>
                `;

                // Generate MoMo QR
                setTimeout(() => {
                    const qrContainer = document.getElementById('momoQR');
                    if (qrContainer && qrContainer.innerHTML === '') {
                        const qrData = `2|99|0901234567|||0|0|${currentOrder.total}|MOMO|MLC${currentOrder.id.slice(-8).toUpperCase()}`;
                        new QRCode(qrContainer, {
                            text: qrData,
                            width: 120,
                            height: 120,
                            colorDark: "#ffffff",
                            colorLight: "#ae2070",
                            correctLevel: QRCode.CorrectLevel.H
                        });
                    }
                }, 100);
            }
        }

        // Print bill
        function printBill() {
            window.print();
        }

        // Update cart count ‚Äî gi·ªè h√†ng ƒë√£ ƒë∆∞·ª£c x√≥a sau khi thanh to√°n, lu√¥n = 0
        function updateCartCount() {
            document.getElementById('cartCount').textContent = 0;
        }

        // Initialize
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.querySelector('.loading-overlay').classList.add('hidden');
            }, 500);

            renderOrder();
            updateCartCount();
        });

        window.addEventListener('scroll', () => {
            const header = document.getElementById('header');
            header.classList.toggle('scrolled', window.scrollY > 50);
        });
    </script>
    <script type="module">
        import { updateMsgBadge, loadStoreInfo } from './js/nav-helper.js';
        loadStoreInfo();
        import { auth, onAuthStateChanged } from './js/firebase-config.js';
        onAuthStateChanged(auth, user => updateMsgBadge(user ? user.uid : null));
    </script>
</body>

</html>